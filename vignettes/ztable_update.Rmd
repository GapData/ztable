---
title: "ztable Update"
author: "Keon-Woong Moon"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{ztable_update}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = NA
)
```

# Introduction

If you are unfamiliar to ztable, please read the ztable vignette: https://cran.r-project.org/web/packages/ztable/vignettes/ztable.html

## Make table from a data.frame

Package "ztable" make everything possible about table. Basically, An object of "ztable" made from a data.frame. The default output format of ztable is RStudio::viewer or web-browser format(type="viewer"). So if you want to use ztable in a "html" format, you should change the parameter ztable.type to "html". If you want to use ztable in latex format, you should change the parameter ztable.type to "latex". 

```{r,results='asis'}
library(ztable)
library(magrittr)
options(ztable.type="html")
z=ztable(head(iris))
z
```

## Use background and font color

You can change background color and font color with bg and color arguments in addRowColor(), addColColor() and addCellColor() functions.

```{r,results='asis'}
ztable(head(iris)) %>%
    addRowColor(rows=1,bg="#C90000",color="white") %>%
    addCellColor(rows=3,cols=c(4,6), bg="cyan",color="red") %>%
    print
```


## Use of color palette

You can use color palettes from RColorBrewer packages. You can extract colors from palette by using palette2colors() function.

```{r}
require(RColorBrewer)

reds=palette2colors("Reds")
reds
```

You can use the extracted colors to your ztable.

```{r,results='asis'}
ztable(head(iris)) %>% 
    addColColor(cols=1:6,bg=reds)

ztable(head(mtcars)) %>%
    addRowColor(rows=1:7,bg=palette2colors("Set3"))
```

## Make a flextable from a ztable

You can use ztable for html nad latex output. But it is impossible to use ztable in `Microsoft Word` or `Microsoft Powerpoint` output directly. The `officer` package by David Gohel makes it possible to access and manipulate `Microsoft Word` or `Microsoft Powerpoint` document. You can insert a flextable object office documents with officer package.

```{r}
require(officer)
require(flextable)

ft=regulartable(head(iris))
ft
```

You can make a 'Microsoft Word' document  with this flextable. 

```{r}
read_docx() %>%
    body_add_flextable(ft) %>%
    print(target = "flextable.docx")
```

You can convert an object of class ztable to a flextable object. 

```{r,results='asis'}
cgroup=c("Sepal","Petal","Species")
n.cgroup=c(2,2,1)
z <- ztable(head(iris)) %>%
    addcgroup(cgroup=cgroup,n.cgroup=n.cgroup,color=c("red","green","blue")) %>%
    spanRow(col=4,from=2,to=3,bg="cyan") %>%
    spanCol(row=5,from=2,to=3,bg="cyan",color="blue")
z
ztable2flextable(z)
```


```{r,results='asis'}
fit <- lm(mpg ~ cyl + disp + wt + drat + am, data=mtcars)
z=ztable(fit)
z
ztable2flextable(z) %>% autofit()
```

For more options of flextable, please read the flextable vignette at https://davidgohel.github.io/flextable/index.html. 

